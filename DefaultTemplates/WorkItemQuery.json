{
    "id":"WorkItemQuery",
    "templates": [
      {
        "id": "mskold-Grid",
        "name": "Grid",
        "serviceName": "WorkItemQuery",
        "description": "A TFS grid optimized for design and UX",
        "docType": "xls",
        "template": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">\n\n  <xsl:template match=\"/\">\n    <html>\n \n\n      <body>\n        <div class=\"query-result-grid work-item-list grid has-header has-gutter\" id=\"27\" role=\"grid\" aria-readonly=\"true\" style=\"height:1000px;\">\n          <div class=\"grid-focus\" tabindex=\"0\" role=\"grid\"></div>\n          \n                     <xsl:apply-templates select=\"/result/columns\" mode=\"th\"/>\n\n                <div class=\"grid-canvas ui-draggable\">\n\n                  <xsl:apply-templates select=\"/result/workitem\" mode=\"row\"/>\n\n\n                </div>\n              </div>\n      \n      </body>\n\n    </html>\n  </xsl:template>\n\n  <xsl:template match=\"result/columns\" mode=\"th\">\n  \n        <div class=\"grid-header\">\n          <div class=\"grid-header-canvas\" role=\"gridcell\" style=\"left: 20px;\">\n            <xsl:for-each select=\"*\">\n            <div title=\"{@name}\" class=\"grid-header-column\" style=\"width: {@width}px;\">\n            <div class=\"separator\"></div>\n            <div class=\"title\"><xsl:value-of select=\"@name\"/></div>\n            <div class=\"sort-handle\"></div>\n          </div>\n          </xsl:for-each>\n        </div>\n        <div class=\"grid-gutter-header\"></div>\n      </div>\n  </xsl:template>\n\n\n  <xsl:template match=\"//workitem\" mode=\"row\">\n  \n      \n        <div class=\"grid-row grid-row-normal \"  role=\"row\" style=\"left: 20px; top: {26 * position()}px; width: 874px; height: 26px;\">\n\n          <xsl:variable name=\"collectionUrl\" select=\"/result/@collectionUrl\"></xsl:variable>\n          <xsl:variable name=\"curRow\" select=\"*[name()!='workitem']\"></xsl:variable>\n\n          <xsl:for-each select=\"/result/columns/*\">\n            \n            <xsl:variable name=\"columnField\" select=\"name()\"/>\n            <xsl:variable name=\"columnWidth\" select=\"@width\"/>\n            \n            <xsl:variable name=\"value\" select=\"$curRow[name()=$columnField]\"/>\n\n            <xsl:variable name=\"bgColor\" >\n              <xsl:choose>\n                <xsl:when test=\"$columnField='Microsoft.VSTS.Common.Priority'\">\n                  <xsl:if test=\"$value=1\">\n                    red\n                  </xsl:if>\n                </xsl:when>\n                </xsl:choose>\n            </xsl:variable>\n\n\n       \n\n            <div title=\"{$value}\" class=\"grid-cell\" role=\"gridcell\" style=\"width: {$columnWidth}px;background-color:{$bgColor}\">\n              <xsl:if test=\"$value[@md5!='']\">\n                <img style =\"float:left;height:24px \" src=\"{$collectionUrl}/_api/_common/IdentityImage?Id=&amp;identifier={$value/@email}&amp;resolveAmbiguous=false&amp;identifierType=0&amp;size=1&amp;__v=5'\">\n<!--           <img src=\"http://www.gravatar.com/avatar/{$value/@md5}\" style=\"display:inline; height=24px;width:24px;\"> -->\n\n                <xsl:attribute name=\"alt\">\n                    <xsl:value-of select=\"$value\"/>\n                  </xsl:attribute>\n                  <xsl:attribute name=\"title\">\n                    <xsl:value-of select=\"$value\" />\n                  </xsl:attribute>\n                </img>\n              </xsl:if>\n\n              <xsl:value-of select=\"$value\" />\n            </div>\n              \n            \n            </xsl:for-each>\n       \n        </div>\n\n    \n    \n\n  </xsl:template>\n\n\n</xsl:stylesheet>",
        "unSaved": "",
        "__etag": -1
      },
      {
        "id": "mskold-export-table",
        "name": "Export table",
        "serviceName": "WorkItemQuery",
        "description": "A table optimized for exporting to excel",
        "template": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">\n\n  <xsl:template match=\"/\">\n    <html content-type=\"application/vnd.ms-excel\">\n \n\n    <body>\n      <table  aria-readonly=\"true\" >\n          <xsl:apply-templates select=\"/result/columns\" mode=\"th\"/>\n          <tbody>\n                  <xsl:apply-templates select=\"/result/workitem\" mode=\"row\"/>\n          </tbody>\n      </table>\n      </body>\n\n    </html>\n  </xsl:template>\n\n  <xsl:template match=\"result/columns\" mode=\"th\">\n  \n        <thead class=\"grid-header\" style=\"position:relative\">\n          \n          <tr class=\"grid-header-canvas\" style=\"position:relative;text-align:left\" >\n            <xsl:for-each select=\"*\">\n            <th title=\"{@name}\" class=\"grid-header-column\" style=\"width: {@width}px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; vertical-align: middle; text-align: left; cursor: default; padding: 4px;\" >\n             <xsl:value-of select=\"@name\"/>\n              </th>\n          \n          </xsl:for-each>\n        </tr>\n        \n      </thead>\n  </xsl:template>\n\n\n  <xsl:template match=\"//workitem\" mode=\"row\">\n\n       <tr>\n          <xsl:variable name=\"collectionUrl\" select=\"/result/@collectionUrl\"></xsl:variable>\n          <xsl:variable name=\"curRow\" select=\"*[name()!='workitem']\"></xsl:variable>\n\n          <xsl:for-each select=\"/result/columns/*\">\n            \n            <xsl:variable name=\"columnField\" select=\"name()\"/>\n            <xsl:variable name=\"columnWidth\" select=\"@width\"/>\n            \n            <xsl:variable name=\"value\" select=\"$curRow[name()=$columnField]\"/>\n\n            <xsl:variable name=\"bgColor\" >\n              <xsl:choose>\n                <xsl:when test=\"$columnField='Microsoft.VSTS.Common.Priority'\">\n                  <xsl:if test=\"$value=1\">\n                    red\n                  </xsl:if>\n                  \n                </xsl:when>\n                </xsl:choose>\n            </xsl:variable>\n\n           <td title=\"{$value}\" class=\"grid-cell\"  style=\"width: {$columnWidth}px;background-color:{$bgColor}\">\n              <xsl:if test=\"$value[@md5!='']\">\n                <img style =\"float:left;height:24px \" src=\"{$collectionUrl}/_api/_common/IdentityImage?Id=&amp;identifier={$value/@email}&amp;resolveAmbiguous=false&amp;identifierType=0&amp;size=1&amp;__v=5'\">\n<!--           <img src=\"http://www.gravatar.com/avatar/{$value/@md5}\" style=\"display:inline; height=24px;width:24px;\"> -->\n\n                <xsl:attribute name=\"alt\">\n                    <xsl:value-of select=\"$value\"/>\n                  </xsl:attribute>\n                  <xsl:attribute name=\"title\">\n                    <xsl:value-of select=\"$value\" />\n                  </xsl:attribute>\n                </img>\n              </xsl:if>\n\n              <xsl:value-of select=\"$value\" />\n            </td>\n           </xsl:for-each>\n        </tr>\n  </xsl:template>\n\n</xsl:stylesheet>",
        "docType": "xls",
        "__etag": -1
      },
      {
        "id": "mskold-RequirementSpecification",
        "name": "Requirement Specification",
        "serviceName": "WorkItemQuery",
        "description": "",
        "docType": "doc",
        "template": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">\n    <xsl:output method=\"html\" indent=\"yes\" encoding=\"Windows-1252\"/>\n\n  <xsl:template match=\"/\">\n    \n    <html>\n <head>\n <meta charset=\"UTF-8\" />       <style>\n          body {font-family: 'Segoe UI'; font-size: 11px;}\n          .StoryInfo{font-size: '9px';}\n          .tag-box{\n            margin-left:6 px;\n            padding-left: 6px;\n          padding-top: 2px;\n        padding-right: 6px;\n        padding-bottom: 2px;\n        font-size: 9px;\n        color: #4F4F4F;\n        background-color: #d7e6f3;\n        }\n        h2 {font-size: 22px; margin-bottom:2px;}\n        h3 {font-size: 18px; margin-bottom:2px;}\n        h4 {font-size: 14px; margin-bottom:2px;}\n        \n        .AcceptanceCriteriaHeader {font-weight:bold;}\n        </style>\n      </head>\n      <body>\n<!-- Insert a fake table to force word to load the output as a doc -->\n  <table>\n          <tr>\n            <td></td>\n          </tr>\n        </table>\n\n        <h1>Requirement specification</h1>\n\n        <xsl:apply-templates select=\"*\" />\n    \n\n        <p/>\n      </body>\n    </html>\n  </xsl:template>\n  \n  <xsl:template match=\"//workitem\">\n    \n      <xsl:variable name=\"level\" select=\"count(ancestor-or-self::*) \"/>\n   \n      <xsl:element name=\"h{$level}\">\n         <xsl:number level=\"multiple\" format=\"1. \"/> \n        <xsl:value-of select=\"System.Title\" />\n      </xsl:element >\n    \n    <div style=\"margin-left:15px;\">\n\n\n      <div class=\"StoryInfo\">\n        <hr/>\n       #<xsl:value-of select=\"System.Id\" />\n        State:<xsl:value-of select=\"System.State\" />\n       Assigned to: <xsl:value-of select=\"System.AssignedTo\" />\n      Tags: <xsl:apply-templates select=\"System.Tags/tag\" />\n        <hr/>\n      </div>\n       <xsl:apply-templates select=\"System.Description\" />\n      \n      <xsl:apply-templates select=\"Microsoft.VSTS.Common.AcceptanceCriteria\" />\n      \n      <xsl:apply-templates select=\"workitem\" />\n    </div>\n  </xsl:template>\n    \n  <xsl:template match=\"//tag\">\n\n    <span class=\"tag-box\">\n      <xsl:value-of select=\"text()\" />\n      </span>\n  </xsl:template>\n\n  \n    \n  <xsl:template match=\"//System.Description\">\n\n      <xsl:copy-of select=\"*\" />\n  </xsl:template>\n  <xsl:template match=\"//Microsoft.VSTS.Common.AcceptanceCriteria\">\n\n    <span class=\"AcceptanceCriteriaHeader\">Acceptance criteria:</span>\n    <br/>\n      <xsl:copy-of select=\"*\" />\n  </xsl:template>\n  \n\n\n</xsl:stylesheet>",
        "unSaved": "",
        "__etag": -1
      }

    ]
}
